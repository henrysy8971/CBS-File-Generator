##################################################
# Application Configuration
##################################################
spring.application.name=cbs-file-generator
server.port=${SERVER_PORT:8080}                      # Default port 8080 if not set
server.servlet.context-path=/cbs-file-generator

##################################################
# Async Task Execution
##################################################
spring.task.execution.pool.core-size=${ASYNC_CORE_POOL:5}
spring.task.execution.pool.max-size=${ASYNC_MAX_POOL:10}
spring.task.execution.pool.queue-capacity=${ASYNC_QUEUE_CAPACITY:100}
spring.task.execution.thread-name-prefix=async-task-

##################################################
# JPA / Hibernate Configuration
##################################################
spring.jpa.database-platform=org.hibernate.dialect.Oracle10gDialect
spring.jpa.hibernate.ddl-auto=none                   # Production: do not auto-create tables
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

##################################################
# DataSource (Oracle) Configuration
##################################################
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.datasource.url=jdbc:oracle:thin:@${DB_HOST:localhost}:${DB_PORT:1521}:${DB_SID:CBSDEVPDB}
spring.datasource.username=${DB_USERNAME:CBSDEV}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.hikari.minimum-idle=${DS_MIN_IDLE:5}
spring.datasource.hikari.maximum-pool-size=${DS_MAX_POOL:20}
spring.datasource.hikari.idle-timeout=${DS_IDLE_TIMEOUT:600000}
spring.datasource.hikari.max-lifetime=${DS_MAX_LIFETIME:1800000}
spring.datasource.hikari.connection-timeout=${DS_CONN_TIMEOUT:30000}
spring.datasource.test-while-idle=true
spring.datasource.validation-query=SELECT 1 FROM DUAL

##################################################
# Spring Batch Configuration
##################################################
spring.batch.job.enabled=false
spring.batch.initialize-schema=never                # Production: assume tables exist

##################################################
# Quartz Scheduler Configuration
##################################################
spring.quartz.job-store-type=jdbc
spring.quartz.jdbc.initialize-schema=never
spring.quartz.properties.org.quartz.scheduler.instanceName=CBSFileGenerator
spring.quartz.properties.org.quartz.scheduler.instanceId=AUTO
spring.quartz.properties.org.quartz.scheduler.wrapJobExecutionInUserTransaction=true

spring.quartz.properties.org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool
spring.quartz.properties.org.quartz.threadPool.threadCount=${QUARTZ_THREAD_COUNT:10}
spring.quartz.properties.org.quartz.threadPool.threadPriority=5

spring.quartz.properties.org.quartz.jobStore.class=org.quartz.impl.jdbcjobstore.JobStoreTX
spring.quartz.properties.org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.oracle.OracleDelegate
spring.quartz.properties.org.quartz.jobStore.useProperties=true
spring.quartz.properties.org.quartz.jobStore.dataSource=quartzDataSource
spring.quartz.properties.org.quartz.jobStore.tablePrefix=QRTZ_
spring.quartz.properties.org.quartz.jobStore.isClustered=${QUARTZ_CLUSTERED:false}
spring.quartz.properties.org.quartz.jobStore.maxMisfiredTriggersToHandleAtATime=1

spring.quartz.properties.org.quartz.dataSource.quartzDataSource.driver=oracle.jdbc.OracleDriver
spring.quartz.properties.org.quartz.dataSource.quartzDataSource.URL=jdbc:oracle:thin:@${DB_HOST:localhost}:${DB_PORT:1521}:${DB_SID:CBSDEVPDB}
spring.quartz.properties.org.quartz.dataSource.quartzDataSource.user=${DB_USERNAME:CBSDEV}
spring.quartz.properties.org.quartz.dataSource.quartzDataSource.password=${DB_PASSWORD:}
spring.quartz.properties.org.quartz.dataSource.quartzDataSource.maxConnections=${QUARTZ_MAX_CONNS:5}

##################################################
# Logging Configuration
##################################################
logging.level.root=INFO
logging.level.com.silverlakesymmetri.cbs.fileGenerator=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.file.name=${LOG_DIR:/opt/cbs/logs}/cbs-file-generator.log

##################################################
# File Generation Configuration
##################################################
file.generation.output-directory=${FILE_OUTPUT_DIR:/opt/cbs/generated-files/}
file.generation.archive-directory=${FILE_ARCHIVE_DIR:/opt/cbs/archived-files/}
file.generation.temp-directory=${FILE_TEMP_DIR:/opt/cbs/temp-files/}
file.generation.log-directory=${FILE_LOG_DIR:/opt/cbs/logs/}
file.generation.chunk-size=${FILE_CHUNK_SIZE:1000}
file.generation.thread-count=${FILE_THREAD_COUNT:10}
file.generation.max-threads=${FILE_MAX_THREADS:50}
file.generation.max-file-size=${FILE_MAX_SIZE:100MB}
file.generation.max-file-age=${FILE_MAX_AGE:30d}

##################################################
# XSD Validation
##################################################
validation.xsd.schema-location=classpath:xsd/
validation.xsd.strict-mode=true

##################################################
# Authentication / Token
##################################################
auth.token.header-name=${AUTH_TOKEN_HEADER:X-DB-Token}
auth.token.enable-validation=${AUTH_TOKEN_VALIDATION:true}

##################################################
# Actuator (Optional)
##################################################
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.endpoints.web.base-path=/actuator

##################################################
# Cache refresh interval in milliseconds (default 5 minutes)
##################################################
app.config.cache-refresh-interval-ms=300000

batch.chunk.size=1000
